[{"/Users/ducdoan2002/Desktop/chat-app/client/src/index.js":"1","/Users/ducdoan2002/Desktop/chat-app/client/src/components/App.jsx":"2","/Users/ducdoan2002/Desktop/chat-app/client/src/components/Login.jsx":"3","/Users/ducdoan2002/Desktop/chat-app/client/src/components/Dashboard.jsx":"4","/Users/ducdoan2002/Desktop/chat-app/client/src/customHooks/useLocalStorage.js":"5","/Users/ducdoan2002/Desktop/chat-app/client/src/components/Sidebar.jsx":"6","/Users/ducdoan2002/Desktop/chat-app/client/src/components/Conversations.jsx":"7","/Users/ducdoan2002/Desktop/chat-app/client/src/components/Contact.jsx":"8","/Users/ducdoan2002/Desktop/chat-app/client/src/components/contexts/ContactsProvider.jsx":"9","/Users/ducdoan2002/Desktop/chat-app/client/src/components/modal/ConversationModal.jsx":"10","/Users/ducdoan2002/Desktop/chat-app/client/src/components/modal/ContactModal.jsx":"11","/Users/ducdoan2002/Desktop/chat-app/client/src/components/contexts/ConversationProvider.jsx":"12","/Users/ducdoan2002/Desktop/chat-app/client/src/components/CurrentConversation.jsx":"13","/Users/ducdoan2002/Desktop/chat-app/client/src/components/SocketProvider.jsx":"14"},{"size":276,"mtime":1648270627654,"results":"15","hashOfConfig":"16"},{"size":877,"mtime":1653264575876,"results":"17","hashOfConfig":"16"},{"size":1291,"mtime":1652414541404,"results":"18","hashOfConfig":"16"},{"size":556,"mtime":1653085340572,"results":"19","hashOfConfig":"16"},{"size":1375,"mtime":1652596853540,"results":"20","hashOfConfig":"16"},{"size":2463,"mtime":1653535089454,"results":"21","hashOfConfig":"16"},{"size":3582,"mtime":1653885548519,"results":"22","hashOfConfig":"16"},{"size":366,"mtime":1653837122362,"results":"23","hashOfConfig":"16"},{"size":701,"mtime":1652595169582,"results":"24","hashOfConfig":"16"},{"size":1557,"mtime":1652973422134,"results":"25","hashOfConfig":"16"},{"size":1316,"mtime":1652671007153,"results":"26","hashOfConfig":"16"},{"size":4941,"mtime":1653535447502,"results":"27","hashOfConfig":"16"},{"size":3554,"mtime":1653350884116,"results":"28","hashOfConfig":"16"},{"size":839,"mtime":1653450974571,"results":"29","hashOfConfig":"16"},{"filePath":"30","messages":"31","suppressedMessages":"32","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"mnivhc",{"filePath":"33","messages":"34","suppressedMessages":"35","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"36"},{"filePath":"37","messages":"38","suppressedMessages":"39","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"40"},{"filePath":"41","messages":"42","suppressedMessages":"43","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"44","messages":"45","suppressedMessages":"46","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"47"},{"filePath":"48","messages":"49","suppressedMessages":"50","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"51","messages":"52","suppressedMessages":"53","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"54"},{"filePath":"55","messages":"56","suppressedMessages":"57","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"58"},{"filePath":"59","messages":"60","suppressedMessages":"61","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"62","messages":"63","suppressedMessages":"64","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"65","messages":"66","suppressedMessages":"67","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"68","messages":"69","suppressedMessages":"70","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"71","usedDeprecatedRules":"72"},{"filePath":"73","messages":"74","suppressedMessages":"75","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"76","messages":"77","suppressedMessages":"78","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"/Users/ducdoan2002/Desktop/chat-app/client/src/index.js",[],[],"/Users/ducdoan2002/Desktop/chat-app/client/src/components/App.jsx",["79"],[],"import React, {useState} from 'react';\nimport Login from \"./Login\";\nimport Dashboard from './Dashboard';\nimport useLocalStorage from '../customHooks/useLocalStorage';\nimport ContactsProvider from './contexts/ContactsProvider';\nimport ConversationProvider from './contexts/ConversationProvider';\nimport SocketProvider from './SocketProvider';\n\n\nfunction App() {\n  //store the id value for now the uuidV4 random id\n  const [id, setId] = useLocalStorage('id');\n  console.log(id); \n  return (\n    <div className=\"App\">\n      {id ? <SocketProvider id={id}>\n              <ContactsProvider>\n                <ConversationProvider id={id}>\n                  <Dashboard id={id}/>\n                </ConversationProvider>\n              </ContactsProvider>\n            </SocketProvider>\n          : \n            <Login onIdSubmit = {setId}/>\n      }\n    </div>\n  );\n}\n\nexport default App;\n","/Users/ducdoan2002/Desktop/chat-app/client/src/components/Login.jsx",["80"],[],"import React, {useRef, useEffect} from 'react';\nimport {Button, Container, Form} from \"react-bootstrap\";\nimport {v4 as uuidV4} from 'uuid';\n\nexport default function Login(props) {\n  const userId = useRef();\n  // const handleSubmit = (e) => {\n  //   e.preventDefault();\n  //   //value from Form.Control\n  //   props.onIdSubmit(userId.current.value);\n  //   console.log(\"Submit\");\n  // }\n\n  const createId = () => {\n    props.onIdSubmit(uuidV4());\n  }\n  return (\n    <Container className=\"d-flex align-items-center justify-content-center\" style={{height: \"100vh\"}}>\n        <Form /*onSubmit={handleSubmit}*/>\n            <Form.Group controlId=\"formBasicEmail\">\n                <Form.Label>ID</Form.Label>\n                <Form.Control type=\"text\" placeholder=\"Enter ID\" ref = {userId}/>\n                <Form.Text className=\"text-muted\">\n                We'll never share your email with anyone else.\n                </Form.Text>\n            </Form.Group>\n            {/* uncomment type = submit to submit the form + trigger onSubmit */}\n            <Button /*type=\"submit\"*/ className=\"me-2\">\n              Log In\n            </Button>\n            <Button variant=\"secondary\" onClick={createId}>\n              Create a new account\n            </Button>\n        </Form>\n    </Container>\n  )\n}\n","/Users/ducdoan2002/Desktop/chat-app/client/src/components/Dashboard.jsx",[],[],"/Users/ducdoan2002/Desktop/chat-app/client/src/customHooks/useLocalStorage.js",["81"],[],"import React, {useEffect, useState} from 'react'\n\nconst PREFIX = \"chat-app-clone-\";\n/*\n    useLocalStorage is a custom Hook of useState\n*/\n//key is where the thing you store in localStorange. (to put it to the prefixKey -> find the correct value)\n//initialValue is the parameter that you pass to useState (could be as a function or just a variable)\n\nexport default function useLocalStorage(key, initialValue) {\n    //read from localStorage + store data to our state\n    let prefixKey = PREFIX + key;\n    const [value, setValue] = useState(()=>{\n        //get the value on localStorage \n        const jsonVal = localStorage.getItem(prefixKey);\n        //every return below are all for set the value [value, setValue] initially\n        if (jsonVal != null){\n            return JSON.parse(jsonVal);         \n        }\n        //passing function to initialValue (useState(()=>{})) \n        if (typeof(initialValue) === \"function\"){\n            return initialValue();\n        }else{\n            return initialValue;\n        }\n    });\n\n    //get value(state) and save to the localStorage\n    useEffect(()=>{\n        //set the value you want to store to localStorage\n        if (value){\n            //stringify here to make JS becomes JSON data\n            localStorage.setItem(prefixKey, JSON.stringify(value));\n        }\n    }, [prefixKey,value])\n\n    return [value, setValue];\n}\n","/Users/ducdoan2002/Desktop/chat-app/client/src/components/Sidebar.jsx",[],[],"/Users/ducdoan2002/Desktop/chat-app/client/src/components/Conversations.jsx",["82","83"],[],"import React, {useEffect, useState} from 'react'\nimport { ListGroup } from 'react-bootstrap';\nimport { useConversation } from './contexts/ConversationProvider';\n\nexport default function Conversations() {\n  const cons = useConversation();\n  //this global var is for the useEffect Hook in setting a new value to the state renderOnMessage everytime there is a \n  //new message.\n  let NEWEST_CONVERSATION_LENGTH = 0;\n  //this global var hold the id of the receiver who receives the newest message (see newestSender prop in ConversationProvider)\n  let NEWEST_SENDER = cons.newestSender;\n\n  //find the newest conversation where the selectedUser is the same as the newestSender\n  if (NEWEST_SENDER){\n    const foundConversation = cons.conversations.find(conver => conver.selectedUser[0] === NEWEST_SENDER)\n      || cons.conversations.find(conver => conver.message[conver.message.length-1].sender === NEWEST_SENDER);\n      NEWEST_CONVERSATION_LENGTH = foundConversation.message.length;\n  }\n\n  const [renderOnMessage, setRenderOnMessage] = useState(NEWEST_SENDER);\n\n  useEffect(()=>{\n    setRenderOnMessage(NEWEST_SENDER);\n  },[NEWEST_CONVERSATION_LENGTH])\n\n  const handleClickConversation = (i) => {\n    cons.setSelectedConversationIndex(i);\n  } \n\n  console.log(cons);\n  const displayNoneNewestSender =  () => {\n    return cons && cons.conversations.map((conver, index) => {\n      return(\n      <ListGroup.Item\n        key = {index}\n        //set the action to make the Item like the Button\n        action\n        onClick={() => handleClickConversation(index)}\n        active={cons.conversations[index].selected}\n      >\n        {conver.recipient.map(re => re.username).join(',')}\n      </ListGroup.Item>\n    )})\n  }\n\n  const displayNewestSender = () => {\n    const changeOrderConversations = [];\n    const found = cons.conversations.find(conver => conver.selectedUser[0] === NEWEST_SENDER) \n                  || cons.conversations.find(conver => conver.message[conver.message.length-1].sender === NEWEST_SENDER);\n    changeOrderConversations.push(found);\n    cons.conversations.filter(conver => {\n      if (conver !== found){\n        changeOrderConversations.push(conver);\n      }\n    })\n\n    const handleClickConversationSpecial = (i,e)=> {\n      // e.target.style.cssText = 'fontWeight: normal';\n      setRenderOnMessage(prev => !prev);\n      NEWEST_SENDER = \"\";\n      cons.setSelectedConversationIndex(i);\n    }\n\n    return changeOrderConversations.map((conver, index) => {\n      return(\n        <>\n        {conver.selectedUser[0] === NEWEST_SENDER?\n          <ListGroup.Item\n          key = {index}\n          //set the action to make the Item like the Button\n          action\n          onClick={() => handleClickConversationSpecial(cons.conversations.indexOf(conver))}\n          active={cons.conversations[cons.conversations.indexOf(conver)].selected}\n          >\n            {conver.recipient.map(re => {return <span style={{fontWeight: 900}}>{re.username}</span> })}\n          </ListGroup.Item>\n          :\n          <ListGroup.Item\n          key = {index}\n          //set the action to make the Item like the Button\n          action\n          onClick={() => handleClickConversation(cons.conversations.indexOf(conver))}\n          active={cons.conversations[cons.conversations.indexOf(conver)].selected}\n        >\n          {conver.recipient.map(re => {return <span>{re.username}</span> })}\n        </ListGroup.Item>}\n        </>\n    )})\n  }\n  return (\n    <ListGroup variant='flush'>\n      {renderOnMessage ? displayNewestSender() : displayNoneNewestSender()}\n    </ListGroup>\n  )\n}\n","/Users/ducdoan2002/Desktop/chat-app/client/src/components/Contact.jsx",[],[],["84","85"],"/Users/ducdoan2002/Desktop/chat-app/client/src/components/contexts/ContactsProvider.jsx",[],[],"/Users/ducdoan2002/Desktop/chat-app/client/src/components/modal/ConversationModal.jsx",[],[],"/Users/ducdoan2002/Desktop/chat-app/client/src/components/modal/ContactModal.jsx",[],[],"/Users/ducdoan2002/Desktop/chat-app/client/src/components/contexts/ConversationProvider.jsx",["86","87"],[],"import React, {useContext, useEffect, useCallback} from 'react';\nimport useLocalStorage from '../../customHooks/useLocalStorage';\nimport { useContacts } from './ContactsProvider';\nimport { useSocket } from '../SocketProvider';\n\nconst ConversationContext = React.createContext();\n\n//small custom Hook\nexport const useConversation = () => {\n    return useContext(ConversationContext);\n}\n\nexport default function ConversationProvider({id, children}) {\n    const [conversations, setConversations] = useLocalStorage('conversations', []);\n    const [selectedConversationIndex, setSelectedConversationIndex] = React.useState(0);\n    const [newestSender, setNewestSender] = React.useState();\n    //storing a new Contact the the state contacts\n    const createConversation = (selectedUser) => {\n        setConversations(prev => [...prev, {selectedUser, message: []}]);\n    }\n    //get all contacts\n    const allContacts = useContacts();\n    //get the socket \n    const socket = useSocket();\n\n\n    //add new recipient property to each conversation in conversations\n    console.log(conversations);\n    const formatConversations = conversations.map((conver, index)=>{\n        //format the contact to display on the page\n        const recipient = conver.selectedUser.map((user)=>{\n            const contact = allContacts.contacts.find(contact => {\n                if (contact.id === user){\n                    return contact;\n                }\n            })\n            const name = contact ? contact.username : user;\n            return {id: user, username: name};\n        })\n        //format the message to display on the page (add fromMe + senderName props to each message object)\n        const formatMessage = conver.message.map((mes)=>{\n            const contact = allContacts.contacts.find(contact => {\n                if (contact.id === mes.sender){\n                    return contact;\n                };\n            })\n            const name = contact ?  contact.username : mes.sender;\n            const fromMe = (mes.sender === id);\n            return {...mes, senderName: name, fromMe};\n        })\n        //update old form message to new formatMessage\n        conver.message = formatMessage;\n        let selected = (index === selectedConversationIndex);\n        return {...conver, recipient, selected};\n    });\n\n    //ultility:\n    const matchRecipient = (arr1, arr2) => {\n        arr1.sort();\n        arr2.sort();\n        if (arr1.length !== arr2.length){\n            return false;\n        }\n        for (let i = 0; i<arr1.length; i++){\n            if (arr1[i] !== arr2[i]){\n                return false;\n            }\n        }\n        return true;\n    }\n\n    const addMessageToConversation = useCallback(({recipient, text, sender}) => {\n        //recipient = a list of user Id, text = text input,sender = user with current Id\n        console.log({recipient, text, sender});\n        setConversations(prev => {\n            let matchConversation = false;\n            //each message just need the sender and the text content\n            const newMessage = {sender, text};\n            setNewestSender(sender);\n            let newConversations = conversations.map((conver) => {\n                if (matchRecipient(conver.selectedUser, recipient)){\n                    matchConversation = true;\n                    return {...conver, message: [...conver.message, newMessage]}\n                }\n                return conver;\n            })\n            if (matchConversation){\n                return newConversations;\n            }\n            else{\n                return [...prev, {selectedUser: recipient, message: [newMessage]}]\n            }\n        })\n    }, [conversations, setConversations])\n    \n    //to control when to trigger socket on receive-message event\n    useEffect(() => {\n        if (socket == null) return;\n        socket.on('receive-message', addMessageToConversation);\n        return () => {\n            //remove all listeners in this receive-message event\n            socket.off('receive-message');\n        };\n    }, [socket, addMessageToConversation]);\n\n    const sendMessage = (recipient,text) => {\n        socket.emit('send-message', {recipient, text});\n        addMessageToConversation({recipient, text, sender: id});\n    }\n\n    //the final value that ConversationContext.Provider holds\n    const output = {\n        //all conversations\n        conversations: formatConversations, \n        //one selected conversation \n        selectedConversation: formatConversations[selectedConversationIndex], \n        //change the selected conversation\n        setSelectedConversationIndex, \n        //create new conversation\n        createConversation,\n        //to store a message to the conversation\n        sendMessage,\n        //keep track with the newest sender\n        newestSender\n    }\n\n    return (\n        <ConversationContext.Provider value={output}>\n            {children}\n        </ConversationContext.Provider>\n    )\n}\n",["88","89"],"/Users/ducdoan2002/Desktop/chat-app/client/src/components/CurrentConversation.jsx",[],[],"/Users/ducdoan2002/Desktop/chat-app/client/src/components/SocketProvider.jsx",[],[],{"ruleId":"90","severity":1,"message":"91","line":1,"column":16,"nodeType":"92","messageId":"93","endLine":1,"endColumn":24},{"ruleId":"90","severity":1,"message":"94","line":1,"column":24,"nodeType":"92","messageId":"93","endLine":1,"endColumn":33},{"ruleId":"90","severity":1,"message":"95","line":1,"column":8,"nodeType":"92","messageId":"93","endLine":1,"endColumn":13},{"ruleId":"96","severity":1,"message":"97","line":24,"column":5,"nodeType":"98","endLine":24,"endColumn":33,"suggestions":"99"},{"ruleId":"100","severity":1,"message":"101","line":51,"column":38,"nodeType":"102","messageId":"103","endLine":51,"endColumn":40},{"ruleId":"104","replacedBy":"105"},{"ruleId":"106","replacedBy":"107"},{"ruleId":"100","severity":1,"message":"108","line":32,"column":63,"nodeType":"102","messageId":"109","endLine":32,"endColumn":65},{"ruleId":"100","severity":1,"message":"108","line":42,"column":63,"nodeType":"102","messageId":"109","endLine":42,"endColumn":65},{"ruleId":"104","replacedBy":"110"},{"ruleId":"106","replacedBy":"111"},"no-unused-vars","'useState' is defined but never used.","Identifier","unusedVar","'useEffect' is defined but never used.","'React' is defined but never used.","react-hooks/exhaustive-deps","React Hook useEffect has a missing dependency: 'NEWEST_SENDER'. Either include it or remove the dependency array.","ArrayExpression",["112"],"array-callback-return","Array.prototype.filter() expects a return value from arrow function.","ArrowFunctionExpression","expectedInside","no-native-reassign",["113"],"no-negated-in-lhs",["114"],"Array.prototype.find() expects a value to be returned at the end of arrow function.","expectedAtEnd",["113"],["114"],{"desc":"115","fix":"116"},"no-global-assign","no-unsafe-negation","Update the dependencies array to be: [NEWEST_CONVERSATION_LENGTH, NEWEST_SENDER]",{"range":"117","text":"118"},[1118,1146],"[NEWEST_CONVERSATION_LENGTH, NEWEST_SENDER]"]